
    
    html_page = f"""<!DOCTYPE html>
<html lang="fi"><head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ty√∂vuorot kalenterit</title>
  <style>
    body {{ font-family: system-ui, -apple-system, Arial, sans-serif; background:#fafafa; margin:0; }}
    .wrap {{ max-width: 760px; margin: 32px auto; padding: 0 16px; }}
    h1 {{ text-align:center; margin: 0 0 16px; }}
    p.note {{ text-align:center; color:#666; margin: 0 0 24px; }}
    .person {{ background:#fff; margin:10px 0; padding:12px 14px; border-radius:10px;
              box-shadow:0 1px 3px rgba(0,0,0,.08); display:flex; justify-content:space-between;
              align-items:center; gap:10px; }}
    .name {{ font-weight:600; }}
    .btns a {{ display:inline-block; padding:8px 10px; border-radius:8px; text-decoration:none;
               border:1px solid #ddd; margin-left:6px; }}
  </style>
</head><body>
<div class="wrap">
  <h1>üìÖ Ty√∂vuorot 2025</h1>
  <p class="note">Valitse oma nimi ja lis√§√§ kalenteri.</p>
  {''.join(cards) if cards else '<p class="note">Ei kalentereita l√∂ytynyt.</p>'}
</div>
<script>
  const base = location.origin + location.pathname.replace(/\\/[^/]*$/, '/') + 'calendars/';
  document.querySelectorAll('.apple').forEach(a => {{
    const u = base + a.dataset.file;
    a.href = 'webcal://' + u.replace(/^https?:\\/\\//, '');
  }});
  document.querySelectorAll('.google').forEach(a => {{
    const u = base + a.dataset.file;
    a.href = 'https://calendar.google.com/calendar/u/0/r?cid=' + encodeURIComponent(u);
  }});
</script>
</body></html>"""
    
